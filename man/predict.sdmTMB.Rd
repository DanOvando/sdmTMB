% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/predict.R
\name{predict.sdmTMB}
\alias{predict.sdmTMB}
\title{Predict from an sdmTMB model}
\usage{
\method{predict}{sdmTMB}(object, newdata = NULL, xy_cols = c("X", "Y"),
  ...)
}
\arguments{
\item{object}{An object from \code{\link[=sdmTMB]{sdmTMB()}}.}

\item{newdata}{An optional new data frame. This should be a single set of
spatial locations. These locations will be expanded to cover all the years
in the original data set. Eventually \code{newdata} will be more flexible.}

\item{xy_cols}{A character vector of length 2 that gives the column names of
the x and y coordinates in \code{newdata}.}

\item{...}{Not implemented.}
}
\value{
A data frame. TODO details.
}
\description{
Can predict on the original data locations or onto new data.
}
\examples{
# We'll only use a small number of knots so this example runs quickly
# but you will likely want to use many more (depending on your data).

pcod_spde <- make_spde(pcod$X, pcod$Y, n_knots = 50)
m <- sdmTMB(
 pcod, density ~ 0 + as.factor(year) + depth_scaled + depth_scaled2,
 time = "year", spde = pcod_spde, family = tweedie(link = "log"),
 silent = FALSE
)

# Predictions at original data locations:
predictions <- predict(m)
cols <- c("year", "X", "Y", "est", "est_fe",
  "est_re_s", "est_re_st", "s_i")
head(predictions[,cols])

predictions <- predict(m, newdata = qcs_grid)

# A short function for plotting our predictions:
library(ggplot2)
plot_map <- function(dat, column = "est") {
  ggplot(dat, aes_string("X", "Y", fill = column)) +
    geom_raster() +
    facet_wrap(~year) +
    coord_fixed()
}

plot_map(predictions, "exp(est)") +
  scale_fill_viridis_c(trans = "sqrt") +
  ggtitle("Prediction (fixed effects + all random effects)")

plot_map(predictions, "exp(est_fe)") +
  ggtitle("Prediction (fixed effects only)") +
  scale_fill_viridis_c(trans = "sqrt")

plot_map(predictions, "est_re_s") +
  ggtitle("Spatial random effects only") +
  scale_fill_gradient2()

plot_map(predictions, "est_re_st") +
  ggtitle("Spatiotemporal random effects only") +
  scale_fill_gradient2()
}
