% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/loglik_cv.R
\name{loglik_cv}
\alias{loglik_cv}
\title{Save log likelihoods of k-fold cross-validation for sdmTMB models}
\usage{
loglik_cv(formula, data, time = "year", x = "X", y = "Y",
  k_folds = 10, fold_ids = NULL, n_knots = NULL,
  spde_function = make_spde, plot_spde = TRUE, ...)
}
\arguments{
\item{formula}{Model formula.}

\item{data}{A data frame.}

\item{time}{Name of the time column.}

\item{x}{Name of the column with X coordinates.}

\item{y}{Name of the column with Y coordinates.}

\item{k_folds}{Number of folds.}

\item{fold_ids}{Optional input name of column containing user chosen fold
ids.}

\item{n_knots}{The number of knots.}

\item{spde_function}{A function that takes 3 arguments (x, y, n_knots) and
returns a list structure that matches output of \code{\link[=make_spde]{make_spde()}}.}

\item{plot_spde}{Logical for whether or not to produce a plot of each mesh.}

\item{...}{All other arguments required to run sdmTMB model with the
exception of \code{data} and \code{spde} which are redefined for each fold within the
function.}
}
\description{
Save log likelihoods of k-fold cross-validation for sdmTMB models
}
\examples{
d <- subset(pcod, year >= 2011) # subset for example speed

# Gaussian
pcod_gaus <- subset(d, density > 0)
kfold <- loglik_cv(formula = log(density) ~ 0 + as.factor(year) + depth_scaled + depth_scaled2,
  pcod_gaus, time = "year", x = "X", y = "Y",
  n_knots = 30, k_folds = 3)
sum(kfold$data$cv_loglik)

# Tweedie:
kfold <- loglik_cv(formula = density ~ 0 + depth_scaled + depth_scaled2 + as.factor(year),
  d, family = tweedie(link = "log"), time = "year", x = "X", y = "Y",
  n_knots = 30, k_folds = 3)
sum(kfold$data$cv_loglik)
}
