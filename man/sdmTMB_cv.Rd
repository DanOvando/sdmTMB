% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cross-val.R
\name{sdmTMB_cv}
\alias{sdmTMB_cv}
\title{Save log likelihoods of k-fold cross-validation for sdmTMB models}
\usage{
sdmTMB_cv(
  formula,
  data,
  x,
  y,
  time = NULL,
  k_folds = 10,
  fold_ids = NULL,
  n_knots = NULL,
  spde_function = make_spde,
  seed = 999,
  ...
)
}
\arguments{
\item{formula}{Model formula.}

\item{data}{A data frame.}

\item{x}{Name of the column with X coordinates.}

\item{y}{Name of the column with Y coordinates.}

\item{time}{The name of the time column. Leave as \code{NULL} if this is only spatial data.}

\item{k_folds}{Number of folds.}

\item{fold_ids}{Optional input name of column containing user chosen fold
ids.}

\item{n_knots}{The number of knots.}

\item{spde_function}{A function that takes 3 arguments (x, y, n_knots) and
returns a list structure that matches output of \code{\link[=make_spde]{make_spde()}}.}

\item{seed}{Provide seed to ensure fold pattern is the same for comparison purposes.}

\item{...}{All other arguments required to run sdmTMB model with the
exception of \code{data} and \code{spde} which are redefined for each fold within the
function.}
}
\description{
Save log likelihoods of k-fold cross-validation for sdmTMB models
}
\examples{
d <- subset(pcod, year >= 2011) # subset for example speed
x <- sdmTMB_cv(
  formula = density ~ 0 + depth_scaled + depth_scaled2 + as.factor(year),
  d, family = tweedie(link = "log"), time = "year", x = "X", y = "Y",
  n_knots = 30, k_folds = 3
)
x$sum_loglik
str(x$data)
x$models[[1]]
x$models[[2]]
\donttest{
# Parallel:
library(future)
plan(multiprocess)
x <- sdmTMB_cv(
  formula = density ~ 0 + depth_scaled + depth_scaled2 + as.factor(year),
  d, family = tweedie(link = "log"), time = "year", x = "X", y = "Y",
  n_knots = 30, k_folds = 4
)
}
}
